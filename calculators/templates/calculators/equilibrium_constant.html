 {% extends 'calculators/calculator_base.html' %}

{% block tool_name %}Denge Sabiti (Kc){% endblock %}
{% block tool_icon %}<i class="fa-solid fa-scale-balanced"></i>{% endblock %}
{% block header_title %}Denge Sabiti (Kc){% endblock %}
{% block header_desc %}Ürün ve giren derişimleri ile Kc hesapla{% endblock %}

{% block input_form %}
<div class="space-y-4">
    <div class="grid grid-cols-3 gap-4">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">[A] (mol/L)</label>
            <input type="number" id="r1" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="0.0001">
            <label class="block text-xs text-gray-500 mt-1">a</label>
            <input type="number" id="a1" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="1" min="0" placeholder="Örn: 1">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">[B]</label>
            <input type="number" id="r2" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="0.0001">
            <label class="block text-xs text-gray-500 mt-1">b</label>
            <input type="number" id="a2" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="1" min="0" placeholder="Örn: 1">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">[C]</label>
            <input type="number" id="r3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="0.0001">
            <label class="block text-xs text-gray-500 mt-1">c</label>
            <input type="number" id="a3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="1" min="0" placeholder="Örn: 0">
        </div>
    </div>
    <div class="grid grid-cols-3 gap-4">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">[P]</label>
            <input type="number" id="p1" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="0.0001">
            <label class="block text-xs text-gray-500 mt-1">x</label>
            <input type="number" id="b1" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="1" min="0" placeholder="Örn: 1">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">[Q]</label>
            <input type="number" id="p2" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="0.0001">
            <label class="block text-xs text-gray-500 mt-1">y</label>
            <input type="number" id="b2" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="1" min="0" placeholder="Örn: 1">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">[R]</label>
            <input type="number" id="p3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="0.0001">
            <label class="block text-xs text-gray-500 mt-1">z</label>
            <input type="number" id="b3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" step="1" min="0" placeholder="Örn: 0">
        </div>
    </div>
    <button onclick="calculateKc()" class="w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 transition mt-4 shadow-lg shadow-blue-200">Hesapla</button>
    <p class="text-xs text-gray-500 mt-2">Kc = ([P]^x [Q]^y [R]^z) / ([A]^a [B]^b [C]^c)</p>
{% endblock %}

{% block extra_results %}
<div id="extra-results" class="mt-4"></div>
{% endblock %}

{% block specific_js %}
<script>
function powOrOne(val, exp){ if (isNaN(val) || val<=0 || isNaN(exp) || exp<=0) return 1; return Math.pow(val, exp); }
function calculateKc(){
  const r = [parseFloat(document.getElementById('r1').value), parseFloat(document.getElementById('r2').value), parseFloat(document.getElementById('r3').value)];
  const a = [parseFloat(document.getElementById('a1').value), parseFloat(document.getElementById('a2').value), parseFloat(document.getElementById('a3').value)];
  const p = [parseFloat(document.getElementById('p1').value), parseFloat(document.getElementById('p2').value), parseFloat(document.getElementById('p3').value)];
  const b = [parseFloat(document.getElementById('b1').value), parseFloat(document.getElementById('b2').value), parseFloat(document.getElementById('b3').value)];
  const num = powOrOne(p[0], b[0]) * powOrOne(p[1], b[1]) * powOrOne(p[2], b[2]);
  const den = powOrOne(r[0], a[0]) * powOrOne(r[1], a[1]) * powOrOne(r[2], a[2]);
  if (den === 0) return;
  const Kc = num / den;
  showResult(Kc.toExponential(6), '');
  window.calcChartData = { type: 'bar', data: [
    { label: 'Pay', value: +num },
    { label: 'Payda', value: +den },
    { label: 'Kc', value: +Kc }
  ]};
  const extra = document.getElementById('extra-results');
  extra.innerHTML = `
    <div class="mt-4 p-3 bg-gray-50 rounded-lg border border-gray-100">
      <p class="text-sm text-gray-700">Pay: <span class="font-bold">${num.toExponential(6)}</span></p>
      <p class="text-sm text-gray-700">Payda: <span class="font-bold">${den.toExponential(6)}</span></p>
    </div>
  `;
}
</script>
{% endblock %}

