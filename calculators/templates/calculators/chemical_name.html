{% extends 'calculators/calculator_base.html' %}

{% block tool_name %}Kimyasal İsim{% endblock %}
{% block tool_icon %}<i class="fa-solid fa-cubes-stacked"></i>{% endblock %}
{% block header_title %}Kimyasal İsim{% endblock %}
{% block header_desc %}İyon adları ve yükleri ile formül ve isim üret{% endblock %}

{% block input_form %}
<div class="space-y-4">
    <div class="grid grid-cols-2 gap-4">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Katyon Adı</label>
            <input type="text" id="cat_name" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Örn: Sodyum">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Katyon Yükü</label>
            <input type="number" id="cat_charge" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Örn: 1" step="1" min="1">
        </div>
    </div>
    <div class="grid grid-cols-2 gap-4">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Anyon Adı</label>
            <input type="text" id="an_name" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Örn: Klorür">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Anyon Yükü</label>
            <input type="number" id="an_charge" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Örn: 1" step="1" min="1">
        </div>
    </div>
    <div class="grid grid-cols-2 gap-4">
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Katyon Sembolü</label>
            <input type="text" id="cat_symbol" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Örn: Na">
        </div>
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Anyon Sembolü</label>
            <input type="text" id="an_symbol" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" placeholder="Örn: Cl">
        </div>
    </div>
    <button onclick="calculateChemicalName()" class="w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 transition mt-4 shadow-lg shadow-blue-200">Hesapla</button>
{% endblock %}

{% block extra_results %}
<div id="extra-results" class="mt-4"></div>
{% endblock %}

{% block info_title %}Açıklama{% endblock %}
{% block info_body %}
Yük dengelemesi ile stokiyometri bulunur ve formül oluşturulur. İsimlendirme basitçe “Katyon Adı + Anyon Adı” biçimindedir.
{% endblock %}

{% block specific_js %}
<script>
function gcd(a,b){ return b ? gcd(b, a % b) : Math.abs(a); }
function lcm(a,b){ return Math.abs(a*b) / gcd(a,b); }
function subscript(n){ return n<=1 ? '' : n.toString(); }
function calculateChemicalName(){
  const catName = (document.getElementById('cat_name').value||'').trim();
  const anName = (document.getElementById('an_name').value||'').trim();
  const catQ = parseInt(document.getElementById('cat_charge').value);
  const anQ = parseInt(document.getElementById('an_charge').value);
  const catSym = (document.getElementById('cat_symbol').value||'').trim();
  const anSym = (document.getElementById('an_symbol').value||'').trim();
  if (!catName || !anName || !catQ || !anQ || !catSym || !anSym) return;
  const m = lcm(catQ, anQ);
  const x = m / catQ;
  const y = m / anQ;
  const formula = `${catSym}${subscript(x)}${anSym}${subscript(y)}`;
  const name = `${catName} ${anName}`;
  showResult(name, '');
  window.calcChartData = { type: 'bar', data: [
    { label: 'Katyon Yükü', value: catQ },
    { label: 'Anyon Yükü', value: anQ },
    { label: 'x', value: x },
    { label: 'y', value: y }
  ]};
  const extra = document.getElementById('extra-results');
  extra.innerHTML = `
    <div class="mt-4 p-3 bg-gray-50 rounded-lg border border-gray-100">
      <p class="text-sm text-gray-700">Formül: <span class="font-bold">${formula}</span></p>
      <p class="text-sm text-gray-700">İsim: <span class="font-bold">${name}</span></p>
    </div>
  `;
}
</script>
{% endblock %}

